<mxfile host="app.diagrams.net" agent="Cursor" version="28.2.9">
  <diagram name="Backend-Logic-Architecture" id="backend-logic-arch">
    <mxGraphModel dx="1200" dy="800" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="850" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- External actors -->
        <mxCell id="ui" value="Web UI&#10;(React)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="1" vertex="1">
          <mxGeometry x="40" y="120" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="onos" value="ONOS Controller&#10;(REST API)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="1" vertex="1">
          <mxGeometry x="900" y="120" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="llm" value="LLM Inference&#10;(Groq API)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="1" vertex="1">
          <mxGeometry x="900" y="230" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="db" value="PostgreSQL&#10;(SQL + pgvector)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="1" vertex="1">
          <mxGeometry x="900" y="340" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="testbed" value="Data Plane Testbed&#10;(ip netns exec)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="1" vertex="1">
          <mxGeometry x="900" y="450" width="160" height="60" as="geometry" />
        </mxCell>

        <!-- Backend container -->
        <mxCell id="backend" value="Backend Application Layer (FastAPI)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#eef2ff;strokeColor=#1f2937;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="220" y="40" width="630" height="520" as="geometry" />
        </mxCell>

        <!-- API Layer -->
        <mxCell id="api_layer" value="API Layer &amp; Security&#10;(Routers + JWT)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="backend" vertex="1">
          <mxGeometry x="30" y="40" width="200" height="120" as="geometry" />
        </mxCell>

        <!-- Core Logic -->
        <mxCell id="core_logic" value="Core Business Logic" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="backend" vertex="1">
          <mxGeometry x="260" y="40" width="220" height="120" as="geometry" />
        </mxCell>
        <mxCell id="intent_engine" value="Intent Translation + Validation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8fafc;strokeColor=#1f2937;" parent="core_logic" vertex="1">
          <mxGeometry x="20" y="50" width="180" height="50" as="geometry" />
        </mxCell>

        <!-- LLM Integration -->
        <mxCell id="llm_block" value="LLM Integration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="backend" vertex="1">
          <mxGeometry x="30" y="190" width="200" height="150" as="geometry" />
        </mxCell>
        <mxCell id="prompt_engine" value="Prompt Engineering" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8fafc;strokeColor=#1f2937;" parent="llm_block" vertex="1">
          <mxGeometry x="20" y="50" width="160" height="40" as="geometry" />
        </mxCell>
        <mxCell id="context_mgr" value="Context Window Manager" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8fafc;strokeColor=#1f2937;" parent="llm_block" vertex="1">
          <mxGeometry x="20" y="95" width="160" height="40" as="geometry" />
        </mxCell>

        <!-- RAG -->
        <mxCell id="rag_block" value="RAG Retrieval&#10;(config_samples + pgvector)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="backend" vertex="1">
          <mxGeometry x="260" y="190" width="220" height="80" as="geometry" />
        </mxCell>

        <!-- ONOS Proxy -->
        <mxCell id="onos_proxy" value="ONOS Proxy Client&#10;(onos_client)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="backend" vertex="1">
          <mxGeometry x="510" y="40" width="200" height="120" as="geometry" />
        </mxCell>

        <!-- Tests Runner -->
        <mxCell id="tests_block" value="Testbed Runner&#10;(sudo allowlist)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="backend" vertex="1">
          <mxGeometry x="510" y="190" width="200" height="80" as="geometry" />
        </mxCell>

        <!-- Data access -->
        <mxCell id="data_access" value="Data Access Layer&#10;(SQLAlchemy ORM)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#1f2937;" parent="backend" vertex="1">
          <mxGeometry x="260" y="300" width="220" height="70" as="geometry" />
        </mxCell>

        <!-- Edges -->
        <mxCell id="e_ui_api" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="1" source="ui" target="api_layer" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_api_core" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="backend" source="api_layer" target="core_logic" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_core_onos" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="backend" source="core_logic" target="onos_proxy" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_onos_ext" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="1" source="onos_proxy" target="onos" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_api_llm" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="backend" source="api_layer" target="llm_block" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_llm_ext" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="1" source="llm_block" target="llm" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_llm_rag" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="backend" source="llm_block" target="rag_block" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_rag_data" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="backend" source="rag_block" target="data_access" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_data_db" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="1" source="data_access" target="db" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_api_tests" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="backend" source="api_layer" target="tests_block" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="e_tests_ext" style="endArrow=block;endFill=1;strokeColor=#374151;" parent="1" source="tests_block" target="testbed" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
